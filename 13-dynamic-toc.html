<html>
<head>
<style>
body {
	font-family: Gotham, "Helvetica Neue", Helvetica, Arial, "sans-serif";
}
* {
	box-sizing: border-box;
}
/* Create two equal columns that floats next to each other */
.column {
	float: left;
	padding: 10px;
	height: 300px; /* Should be removed. Only for demonstration */
}
h2 {
	font-weight: 400;
	padding-top: 0px;
	margin-top: 6px;
}
.columnDivSideBar {
	float: left;
	width: 200px;
	padding: 10px;
	height: 300px; /* Should be removed. Only for demonstration */
}
.columnDivRight {
	float:left;
	border: solid 1px #E1E1E1;
	border-top-right-radius: 5px;
	border-bottom-right-radius: 5px;
	flex: 5;
	width: 40vw;
	padding: 15px 10px 10px 15px;
}
/* Clear floats after the columns */
.sectionContain:after {
	content: "";
	display: flex;
	clear: both;
	position: relative;
	margin-bottom: 10px;
}
.leftC {
	background-color: #E1E1E1;
	border-top-left-radius: 5px;
	border-bottom-left-radius: 5px;
}
ul {
	padding: 0px 5px 5px 10px;
}
li {
	list-style: none;
}
li.currentToc {
	background-color: #4D4D4D;
	color: #FFFFFF;
	border-radius: 5px;
	padding: 2px 0px 3px 8px;
	margin-left: -7px;
}
li.currentToc:before {
	color: #000000 !important;
}
.firstLetter {
	text-transform: capitalize;
}
.dupSlide {
	background-color: #FF0000;
	color: #FFFFFF;
	padding: 6px;
	border-radius: 5px;
}
	
	.innerContentHolder {
		position:relative;
		margin-bottom:25px;
	}
	
	
</style>
<meta charset="UTF-8">
<title>11 dynamic toc</title>
</head>

<body>
<h1>this is a heading</h1>

<div class="innerContentHolder" sectiontitle="section one">
	<div class="sectionContain" slidenum="3" hashtag="third slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" slidenum="7" hashtag="seventh slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" slidenum="8" hashtag="eighth slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" slidenum="2" hashtag="second slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" slidenum="1" hashtag="first slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" slidenum="3" hashtag="third slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" slidenum="2" hashtag="second slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" hashtag="third slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content">test</div>
		  </div>
		</div>
	  </div>
	</div>
	
</div>	
	
<div class="innerContentHolder" sectiontitle="section two">
	<div class="sectionContain" slidenum="3" hashtag="2 third slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" slidenum="8" hashtag="2 eighth slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" slidenum="2" hashtag="2 second slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" slidenum="1" hashtag="2 first slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" slidenum="3" hashtag="third slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>
	<div class="sectionContain" slidenum="2" hashtag="second slide">
	  <div class="sectionFlexContain">
		<div class="columnContainer">
		  <div class="columnDivSideBar leftC">
			<ul class="toc">
			</ul>
		  </div>
		  <div class="columnDivRight">
			<div class="content"></div>
		  </div>
		</div>
	  </div>
	</div>

	
</div>

<script>

        const innerContentHolders = Array.from(document.querySelectorAll('.innerContentHolder'));

        innerContentHolders.forEach(innerContentHolder => {
            const containers = Array.from(innerContentHolder.querySelectorAll('.sectionContain'));
            const sectionTitle = innerContentHolder.getAttribute('sectiontitle');
            const slideSet = new Set();
            const slideData = [];

            containers.forEach((container) => {
                const hashtag = container.getAttribute('hashtag');
                const slidenum = container.getAttribute('slidenum');
                const contentDiv = container.querySelector('.content');

                if (slidenum && hashtag) {
                    if (slideSet.has(slidenum)) {
                        const dupDiv = document.createElement('div');
                        dupDiv.className = 'dupSlide';
                        dupDiv.textContent = 'Duplicate! | slidenum: ' + slidenum + ' | hashtag: ' + hashtag;
                        contentDiv.appendChild(dupDiv);
                        const h2 = document.createElement('h2');
                        h2.textContent = hashtag;
                        contentDiv.append(h2);
                    } else {
                        slideSet.add(slidenum);
                        slideData.push({ slidenum, hashtag });
                        const h2 = document.createElement('h2');
                        h2.textContent = hashtag;
                        contentDiv.prepend(h2);
                    }
                }
            });

            // Remove all containers from innerContentHolder
            containers.forEach((container) => {
                innerContentHolder.removeChild(container);
            });

            // Sort containers by slidenum
            containers.sort((a, b) => a.getAttribute('slidenum') - b.getAttribute('slidenum'));

            // Add containers back to innerContentHolder in sorted order
            containers.forEach((container) => {
                innerContentHolder.appendChild(container);
            });

            // Create table of contents
            containers.forEach((container) => {
                const slidenum = container.getAttribute('slidenum');
                const hashtag = container.getAttribute('hashtag');
                const toc = container.querySelector('.toc');

                if (slidenum && hashtag) {
                    const h2 = document.createElement('h2');
                    h2.className = 'sectionTitle';
                    h2.textContent = sectionTitle;
                    toc.prepend(h2);

                    slideData.sort((a, b) => a.slidenum - b.slidenum).forEach((data) => {
                        const li = document.createElement('li');
                        li.textContent = data.slidenum + '. ' + data.hashtag;
                        if (data.slidenum === slidenum) {
                            li.className = "currentToc";
                        }
                        toc.appendChild(li);
                    });
                }
            });
        });

</script>
	
	<script>
	//window.onload = setTimeout(capHeading, 2000);
	
	//function capHeading() {
		//alert('test');
	  const headers = document.querySelectorAll('h1,h2,h3,h4,h5,h6, ul.toc li');

	  headers.forEach((header) => {
		let text = header.textContent;
		let firstLetterIndex = text.search(/[a-zA-Z]/);  // find first letter
		if (firstLetterIndex >= 0) {
		  text = text.slice(0, firstLetterIndex) 
			+ '<span class="firstLetter">'
			+ text.slice(firstLetterIndex, firstLetterIndex + 1) 
			+ '</span>' 
			+ text.slice(firstLetterIndex + 1);
		  header.innerHTML = text;
		}
	  });
	//}
	</script>
</body>
</html>
