javascript:(function(){if(document.getElementById('llmPrimer-panel')){const a=document.getElementById('llmPrimer-panel');a.style.display=a.style.display==='none'?'block':'none';return}const b=document.createElement('div');b.id='llmPrimer-loading';b.style.position='fixed';b.style.top='20px';b.style.right='20px';b.style.backgroundColor='#fff';b.style.border='1px solid #ccc';b.style.borderRadius='5px';b.style.padding='10px';b.style.boxShadow='0 4px 8px rgba(0,0,0,.1)';b.style.zIndex='10000';b.style.fontFamily='Arial,sans-serif';b.textContent='Loading llmPrimer...';document.body.appendChild(b);const c=document.createElement('script');c.src='https://your-domain.com/path/to/new_llmPrimer_bkm_kbLoader_v1.0_4.10.25.js';document.head.appendChild(c);c.onerror=function(){b.textContent='Failed to load knowledge base data.';b.style.backgroundColor='#ffebee';b.style.color='#d32f2f';setTimeout(()=>{document.body.removeChild(b)},3000)};c.onload=function(){document.body.removeChild(b);d()};function d(){try{console.log("Initializing llmPrimer UI...");const a=document.createElement('div');a.id='llmPrimer-panel';a.style.position='fixed';a.style.top='20px';a.style.right='20px';a.style.width='300px';a.style.backgroundColor='#fff';a.style.border='1px solid #ccc';a.style.borderRadius='5px';a.style.padding='15px';a.style.boxShadow='0 4px 8px rgba(0,0,0,.1)';a.style.zIndex='10000';a.style.fontFamily='Arial,sans-serif';a.style.fontSize='14px';a.style.color='#333';const b=document.createElement('div');b.style.display='flex';b.style.justifyContent='space-between';b.style.alignItems='center';b.style.marginBottom='15px';const c=document.createElement('h3');c.textContent='llmPrimer';c.style.margin='0';c.style.fontSize='16px';c.style.fontWeight='bold';b.appendChild(c);const d=document.createElement('div');d.style.display='flex';d.style.gap='5px';const e=document.createElement('button');e.id='llmPrimer-theme-btn';e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>';e.title='Toggle theme';e.style.border='none';e.style.background='none';e.style.cursor='pointer';e.style.fontSize='16px';e.addEventListener('click',t);d.appendChild(e);const f=document.createElement('button');f.id='llmPrimer-toggle-btn';f.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/></svg>';f.title='Toggle panel';f.style.border='none';f.style.background='none';f.style.cursor='pointer';f.style.fontSize='16px';f.addEventListener('click',v);d.appendChild(f);const g=document.createElement('button');g.id='llmPrimer-close-btn';g.innerText='✕';g.title='Close panel';g.style.border='none';g.style.background='none';g.style.cursor='pointer';g.style.fontSize='16px';g.addEventListener('click',w);d.appendChild(g);b.appendChild(d);a.appendChild(b);const h=document.createElement('div');h.id='llmPrimer-loading-status';h.style.fontSize='12px';h.style.marginBottom='10px';h.style.color='#666';h.textContent='Loading content...';a.appendChild(h);const i=document.createElement('label');i.textContent='Select Category:';i.style.display='block';i.style.marginBottom='5px';i.style.fontSize='14px';a.appendChild(i);const j=document.createElement('select');j.className='categorySelect';j.style.width='100%';j.style.padding='5px';j.style.marginBottom='15px';j.style.borderRadius='3px';j.style.border='1px solid #ccc';const k=document.createElement('option');k.value='';k.textContent='-- Select a category --';j.appendChild(k);if(typeof window.kbCategory==='undefined'||!Array.isArray(window.kbCategory)){console.error('Knowledge base categories not found. Make sure the loader script is properly loaded.');throw new Error('Knowledge base categories not found')}window.kbCategory.forEach(a=>{const b=document.createElement('option');b.value=a.id;b.textContent=a.title;j.appendChild(b)});a.appendChild(j);const l=document.createElement('label');l.textContent='Select Knowledge Base:';l.style.display='block';l.style.marginBottom='5px';l.style.fontSize='14px';a.appendChild(l);const m=document.createElement('select');m.className='knowledgeBaseSelect';m.style.width='100%';m.style.padding='5px';m.style.marginBottom='15px';m.style.borderRadius='3px';m.style.border='1px solid #ccc';m.disabled=true;const n=document.createElement('option');n.value='';n.textContent='-- Select a knowledge base --';m.appendChild(n);a.appendChild(m);const o=document.createElement('div');o.id='llmPrimer-status';o.style.fontSize='12px';o.style.marginBottom='10px';o.style.padding='5px';o.style.borderRadius='3px';o.style.display='none';a.appendChild(o);const p=document.createElement('div');p.style.display='flex';p.style.justifyContent='space-between';p.style.gap='10px';const q=document.createElement('button');q.id='llmPrimer-inject-btn';q.innerText='Inject Prompt';q.style.padding='8px 15px';q.style.borderRadius='3px';q.style.border='1px solid #ccc';q.style.backgroundColor='#f0f0f0';q.style.cursor='pointer';q.style.flex='1';q.disabled=true;q.addEventListener('click',s);p.appendChild(q);const r=document.createElement('button');r.id='llmPrimer-copy-btn';r.innerText='Copy Prompt';r.style.padding='8px 15px';r.style.borderRadius='3px';r.style.border='1px solid #ccc';r.style.backgroundColor='#f0f0f0';r.style.cursor='pointer';r.style.flex='1';r.disabled=true;r.addEventListener('click',u);p.appendChild(r);a.appendChild(p);document.body.appendChild(a);j.addEventListener('change',function(){x(this.value);m.disabled=!this.value;q.disabled=true;r.disabled=true});m.addEventListener('change',function(){q.disabled=!this.value;r.disabled=!this.value});if(typeof window.kbDomain==='undefined'||!Array.isArray(window.kbDomain)){console.error('Knowledge base domains not found. Make sure the loader script is properly loaded.');throw new Error('Knowledge base domains not found')}if(window.kbCategory.length>0){j.value=window.kbCategory[0].id;x(window.kbCategory[0].id);m.disabled=false}y();if(window.llmPrimer&&window.llmPrimer.contentLoadingStatus){const{total,completed,failed}=window.llmPrimer.contentLoadingStatus;h.textContent=`Loading: ${completed}/${total} complete${failed>0?`, ${failed} failed`:''}`}document.addEventListener('llmPrimer_contentLoaded',function(a){console.log("Content loading complete event received:",a.detail);h.textContent=`Loading complete: ${a.detail.success}/${a.detail.total} successful`;setTimeout(()=>{h.style.display='none'},3000);if(m.value){q.disabled=false;r.disabled=false}});console.log("llmPrimer UI initialized successfully")}catch(a){console.error('Error initializing llmPrimer:',a);alert('Failed to initialize: '+a.message)}}function x(a){try{const b=document.querySelector('.knowledgeBaseSelect');if(!b){throw new Error('Select element not found')}while(b.options.length>1){b.remove(1)}const c=window.kbDomain.filter(b=>b.category===a);c.forEach(a=>{const c=document.createElement('option');c.value=a.id;c.textContent=a.title;if(a.loadingStatus){if(a.loadingStatus==='loaded'){c.textContent+=' ✓'}else if(a.loadingStatus==='loading'){c.textContent+=' (loading...)'}else if(a.loadingStatus==='failed'){c.textContent+=' (failed)'}}b.appendChild(c)});if(c.length>0){b.value=c[0].id;const a=document.getElementById('llmPrimer-inject-btn');const d=document.getElementById('llmPrimer-copy-btn');if(a&&d){const b=c[0];const e=!b.loadingStatus||b.loadingStatus==='loaded'||window.llmPrimer.contentLoaded;a.disabled=!e;d.disabled=!e}}}catch(a){console.error('Error populating dropdown:',a);z('Failed to populate dropdown: '+a.message,'error')}}function z(a,b='info'){const c=document.getElementById('llmPrimer-status');if(c){c.textContent=a;c.style.display='block';if(b==='error'){c.style.backgroundColor='#ffebee';c.style.color='#d32f2f'}else if(b==='success'){c.style.backgroundColor='#e8f5e9';c.style.color='#388e3c'}else{c.style.backgroundColor='#e3f2fd';c.style.color='#1976d2'}setTimeout(()=>{c.style.display='none'},5000)}}function A(){try{const a=document.querySelector('.knowledgeBaseSelect');if(!a){throw new Error('Select element not found')}const b=a.value;if(!b){return''}const c=window.kbDomain.find(a=>a.id===b);if(c&&c.markDown){return c.markDown}else if(c){if(c.loadingStatus==='loading'){z('Content is still loading. Please wait...','info')}else if(c.loadingStatus==='failed'){z('Failed to load content. Try refreshing.','error')}else{z('No content available. Content may be loading or failed to load.','error')}console.warn(`No markdown found for ${b}. Loading status: ${c.loadingStatus||'unknown'}`);return''}return''}catch(a){console.error('Error getting markdown:',a);z('Error retrieving content: '+a.message,'error');return''}}async function s(){try{const a=A();if(!a){z('No markdown content available for selected knowledge base.','error');return}let b=document.querySelector("div#prompt-textarea");if(!b){b=document.querySelector("textarea:focus")||document.querySelector("[contenteditable='true']:focus")}if(!b){z("Target textarea not found! Click into a text area first.",'error');return}if(b.tagName&&b.tagName.toLowerCase()==='textarea'){b.value=a;b.dispatchEvent(new Event("input",{bubbles:true}))}else if(b.getAttribute&&b.getAttribute('contenteditable')==='true'){b.textContent=a;b.dispatchEvent(new Event("input",{bubbles:true}))}else{if(b.querySelector&&b.querySelector('p.placeholder')){b=b.querySelector('p.placeholder')}b.innerText=a;b.dispatchEvent(new Event("input",{bubbles:true}));const c=document.createEvent("KeyboardEvent");c.initEvent("keydown",true,true);c.keyCode=13;b.dispatchEvent(c)}z('Content injected successfully!','success');setTimeout(()=>{try{const b=document.querySelector('button[data-testid="send-button"]');if(b){b.click();console.log('Prompt injected and sent')}else{const b=document.querySelector('form button[type="submit"]');if(b){b.click();console.log('Prompt injected and form submitted')}else{console.log('Prompt injected, but send button not found')}}const c=document.querySelector('textarea, [contenteditable="true"]');if(c){c.focus()}}catch(a){console.error('Error triggering send button:',a)}},100)}catch(a){console.error('Error injecting prompt:',a);z('Failed to inject: '+a.message,'error')}}async function u(){try{const a=A();if(!a){z('No content available to copy.','error');return}if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(a);const b=document.getElementById('llmPrimer-copy-btn');if(b){const c=b.innerText;b.innerText='✓ Copied!';setTimeout(()=>{b.innerText=c},2000)}z('Content copied to clipboard!','success')}else{const b=document.createElement('textarea');b.value=a;b.style.position='fixed';b.style.left='-999999px';b.style.top='-999999px';document.body.appendChild(b);b.focus();b.select();let c=false;try{c=document.execCommand('copy')}catch(a){console.error('Error copying text:',a)}document.body.removeChild(b);if(c){const b=document.getElementById('llmPrimer-copy-btn');if(b){const a=b.innerText;b.innerText='✓ Copied!';setTimeout(()=>{b.innerText=a},2000)}z('Content copied to clipboard!','success')}else{z('Failed to copy text. Try again.','error')}}}catch(a){console.error('Error copying prompt:',a);z('Failed to copy: '+a.message,'error')}}function t(){try{const a=document.getElementById('llmPrimer-panel');if(!a){throw new Error('Panel not found')}const b=a.getAttribute('data-theme')==='dark';if(b){a.setAttribute('data-theme','light');a.style.backgroundColor='#fff';a.style.color='#333';a.style.border='1px solid #ccc';const b=a.querySelectorAll('button:not([id="llmPrimer-theme-btn"]):not([id="llmPrimer-toggle-btn"]):not([id="llmPrimer-close-btn"])');b.forEach(a=>{a.style.backgroundColor='#f0f0f0';a.style.color='#333';a.style.border='1px solid #ccc'});const c=a.querySelectorAll('select');c.forEach(a=>{a.style.backgroundColor='#fff';a.style.color='#333';a.style.border='1px solid #ccc'});const d=document.getElementById('llmPrimer-theme-btn');d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>'}else{a.setAttribute('data-theme','dark');a.style.backgroundColor='#333';a.style.color='#fff';a.style.border='1px solid #555';const b=a.querySelectorAll('button:not([id="llmPrimer-theme-btn"]):not([id="llmPrimer-toggle-btn"]):not([id="llmPrimer-close-btn"])');b.forEach(a=>{a.style.backgroundColor='#444';a.style.color='#fff';a.style.border='1px solid #666'});const c=a.querySelectorAll('select');c.forEach(a=>{a.style.backgroundColor='#444';a.style.color='#fff';a.style.border='1px solid #666'});const d=document.getElementById('llmPrimer-theme-btn');d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>'}localStorage.setItem('llmPrimer-theme',b?'light':'dark')}catch(a){console.error('Error toggling theme:',a);z('Error toggling theme','error')}}function y(){try{const a=document.getElementById('llmPrimer-panel');if(!a){throw new Error('Panel not found')}const b=localStorage.getItem('llmPrimer-theme')||'light';if(b==='dark'){a.setAttribute('data-theme','dark');a.style.backgroundColor='#333';a.style.color='#fff';a.style.border='1px solid #555';const b=a.querySelectorAll('button:not([id="llmPrimer-theme-btn"]):not([id="llmPrimer-toggle-btn"]):not([id="llmPrimer-close-btn"])');b.forEach(a=>{a.style.backgroundColor='#444';a.style.color='#fff';a.style.border='1px solid #666'});const c=a.querySelectorAll('select');c.forEach(a=>{a.style.backgroundColor='#444';a.style.color='#fff';a.style.border='1px solid #666'});const d=document.getElementById('llmPrimer-theme-btn');d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>'}else{a.setAttribute('data-theme','light');a.style.backgroundColor='#fff';a.style.color='#333';a.style.border='1px solid #ccc';const b=a.querySelectorAll('button:not([id="llmPrimer-theme-btn"]):not([id="llmPrimer-toggle-btn"]):not([id="llmPrimer-close-btn"])');b.forEach(a=>{a.style.backgroundColor='#f0f0f0';a.style.color='#333';a.style.border='1px solid #ccc'});const c=a.querySelectorAll('select');c.forEach(a=>{a.style.backgroundColor='#fff';a.style.color='#333';a.style.border='1px solid #ccc'});const d=document.getElementById('llmPrimer-theme-btn');d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>'}}catch(a){console.error('Error applying theme:',a)}}function v(){try{const a=document.getElementById('llmPrimer-panel');if(!a){throw new Error('Panel not found')}const b=Array.from(a.children).slice(1);const c=a.getAttribute('data-minimized')==='true';const d=document.getElementById('llmPrimer-toggle-btn');if(c){b.forEach(a=>{a.style.display=''});a.setAttribute('data-minimized','false');d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/></svg>'}else{b.forEach(a=>{a.style.display='none'});a.setAttribute('data-minimized','true');d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="9" y1="3" x2="9" y2="21"/></svg>'}}catch(a){console.error('Error toggling panel:',a)}}function w(){try{const a=document.getElementById('llmPrimer-panel');if(a){a.remove()}}catch(a){console.error('Error closing panel:',a)}}})();