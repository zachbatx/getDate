(function(){if(document.getElementById("llmPrimer-host")){var h=document.getElementById("llmPrimer-host");h.style.display=h.style.display==="none"?"block":"none";return}var c=window.llmPrimerConfig||{},u=c.loaderUrl||"https://your-domain.com/path/to/llmPrimer_bkm_kbLoader_v4.0_.4.16.25.js",t=c.textareaSelector||"#dialog-input-textarea",s=c.sendBtnSelector||'button[data-testid="dialog-input-send"]';window.llmPrimer=window.llmPrimer||{};var e=document.createElement("div");e.id="llmPrimer-host";Object.assign(e.style,{all:"initial",position:"fixed",top:"0",right:"0",zIndex:"100000"});var r=e.attachShadow({mode:"open"});document.body.appendChild(e);r.innerHTML='<style>:host,#panel{font-family:Arial,sans-serif;font-size:14px;}#panel{position:fixed;top:20px;right:20px;width:300px;background:#fff;color:#333;border:1px solid #ccc;border-radius:5px;box-shadow:0 4px 8px rgba(0,0,0,0.1);padding:10px;}#loading{font-size:12px;color:#666;margin-bottom:8px;}label{display:block;margin:8px 0 4px;}select,button{width:100%;padding:6px;margin-bottom:8px;border:1px solid #ccc;border-radius:3px;background:#f9f9f9;cursor:pointer;}button:disabled{opacity:0.5;cursor:default;}</style><div id="panel" data-theme="light"><div id="loading">Loading content…</div><label>Select Category:<select id="category" disabled><option value="">– Loading –</option></select></label><label>Select Knowledge Base:<select id="domain" disabled><option value="">– Loading –</option></select></label><button id="inject" disabled>Inject Prompt</button><button id="copy" disabled>Copy Prompt</button></div>';var p=r.getElementById("panel"),l=r.getElementById("loading"),f=r.getElementById("category"),d=r.getElementById("domain"),m=r.getElementById("inject"),g=r.getElementById("copy"),y=document.createElement("script");y.type="module";y.src=u;y.onerror=function(){alert("⚠️ Failed to load knowledge‑base loader.")};r.appendChild(y);document.addEventListener("llmPrimer_contentLoaded",function(){l.style.display="none";populateCategories()});function populateCategories(){var n=window.kbCategory||[];f.innerHTML='<option value="">-- Select a category --</option>';n.forEach(function(a){var o=document.createElement("option");o.value=a.id;o.textContent=a.title;f.appendChild(o)});f.disabled=false}f.addEventListener("change",function(){var a=f.value,w=(window.kbDomain||[]).filter(function(b){return b.category===a});d.innerHTML='<option value="">-- Select a knowledge base --</option>';w.forEach(function(b){var o=document.createElement("option");o.value=b.id;o.textContent=b.title;d.appendChild(o)});d.disabled=!w.length;m.disabled=g.disabled=true});d.addEventListener("change",function(){var a=!!d.value;m.disabled=g.disabled=!a});m.addEventListener("click",function(){var a=getMarkdown();if(!a)return alert("⚠️ No markdown available.");var b=document.querySelector(t);if(!b)return alert("⚠️ Textarea "+t+" not found.");b.innerText=a;b.dispatchEvent(new Event("input",{bubbles:true}));setTimeout(function(){var c=document.querySelector(s);c&&c.click()},100)});g.addEventListener("click",function(){var a=getMarkdown();if(!a)return alert("⚠️ No markdown to copy.");try{navigator.clipboard.writeText(a)}catch(e){var i=document.createElement("textarea");i.value=a;document.body.appendChild(i);i.select();document.execCommand("copy");document.body.removeChild(i)}alert("✅ Copied to clipboard!")});function getMarkdown(){var a=d.value,e=(window.kbDomain||[]).find(function(b){return b.id===a});return e&&e.markDown?e.markDown:""}})();
