javascript:(function(){if(document.getElementById('llmPrimer-panel')){const a=document.getElementById('llmPrimer-panel');a.style.display=a.style.display==='none'?'block':'none';return}const b=[{id:'designReview',title:'Design Review Tools'},{id:'research',title:'Research Tools'},{id:'accessibility',title:'Accessibility Tools'}];const c=[{id:'usabilityHeuristics',title:'Usability Heuristics',docxUrl:'https://your-confluence.domain/path/to/usabilityHeuristics.docx',category:'designReview'},{id:'accessibilityGuidelines',title:'Accessibility Guidelines',docxUrl:'https://your-confluence.domain/path/to/accessibilityGuidelines.docx',category:'accessibility'},{id:'researchMethods',title:'Research Methods',docxUrl:'https://your-confluence.domain/path/to/researchMethods.docx',category:'research'}];d().then(e).catch(a=>{console.error('Failed to load dependencies:',a);alert('Failed to load required libraries. Please check your network connection and try again.')});function d(){return new Promise((a,b)=>{let c=typeof mammoth!=='undefined';let d=typeof TurndownService!=='undefined';if(!c){const e=document.createElement('script');e.src='https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.17/mammoth.browser.min.js';e.integrity="sha512-Qx0Z8xRfpC+q0mEX2S9OMlEJLGwCYMJbsjXnBqZ+0JIFMCdY+zTbWvNGfEDCVDB7YWkbvOVt9wgE3imP33U7Jw==";e.crossOrigin="anonymous";document.head.appendChild(e);e.onload=()=>{console.log('Mammoth loaded');c=true;f()};e.onerror=a=>{console.error('Failed to load Mammoth:',a);b(new Error('Failed to load Mammoth.js library'))}}if(!d){const e=document.createElement('script');e.src='https://cdnjs.cloudflare.com/ajax/libs/turndown/7.1.1/turndown.min.js';e.integrity="sha512-OtLX4oNRLqLRxRxB/90jOHCQkPSZQQRLMR0gEXm0krJ8YDvP/cdROjpx4dEkd4GEF5O6+/7C5qYNnU8yHYr/Kw==";e.crossOrigin="anonymous";document.head.appendChild(e);e.onload=()=>{console.log('Turndown loaded');d=true;f()};e.onerror=a=>{console.error('Failed to load Turndown:',a);b(new Error('Failed to load Turndown.js library'))}}function f(){if((c||typeof mammoth!=='undefined')&&(d||typeof TurndownService!=='undefined')){a()}}if(c&&d){a()}setTimeout(()=>{if(typeof mammoth!=='undefined'&&typeof TurndownService!=='undefined'){a()}else{b(new Error('Timed out waiting for dependencies'))}},5000)})}function e(){try{const a=document.createElement('div');a.id='llmPrimer-panel';a.style.position='fixed';a.style.top='20px';a.style.right='20px';a.style.width='300px';a.style.backgroundColor='#ffffff';a.style.border='1px solid #cccccc';a.style.borderRadius='5px';a.style.padding='15px';a.style.boxShadow='0 4px 8px rgba(0, 0, 0, 0.1)';a.style.zIndex='10000';a.style.fontFamily='Arial, sans-serif';a.style.fontSize='14px';a.style.color='#333333';const d=document.createElement('div');d.style.display='flex';d.style.justifyContent='space-between';d.style.alignItems='center';d.style.marginBottom='15px';const e=document.createElement('h3');e.textContent='llmPrimer';e.style.margin='0';e.style.fontSize='16px';e.style.fontWeight='bold';d.appendChild(e);const f=document.createElement('div');f.style.display='flex';f.style.gap='5px';const g=document.createElement('button');g.id='llmPrimer-theme-btn';g.innerText='ðŸŒ“';g.title='Toggle theme';g.style.border='none';g.style.background='none';g.style.cursor='pointer';g.style.fontSize='16px';g.addEventListener('click',n);f.appendChild(g);const h=document.createElement('button');h.id='llmPrimer-toggle-btn';h.innerText='âš¡';h.title='Toggle panel';h.style.border='none';h.style.background='none';h.style.cursor='pointer';h.style.fontSize='16px';h.addEventListener('click',o);f.appendChild(h);const i=document.createElement('button');i.id='llmPrimer-close-btn';i.innerText='âœ•';i.title='Close panel';i.style.border='none';i.style.background='none';i.style.cursor='pointer';i.style.fontSize='16px';i.addEventListener('click',p);f.appendChild(i);d.appendChild(f);a.appendChild(d);const j=document.createElement('label');j.textContent='Select Category:';j.style.display='block';j.style.marginBottom='5px';j.style.fontSize='14px';a.appendChild(j);const k=document.createElement('select');k.className='categorySelect';k.style.width='100%';k.style.padding='5px';k.style.marginBottom='15px';k.style.borderRadius='3px';k.style.border='1px solid #ccc';const l=document.createElement('option');l.value='';l.textContent='-- Select a category --';k.appendChild(l);b.forEach(a=>{const b=document.createElement('option');b.value=a.id;b.textContent=a.title;k.appendChild(b)});a.appendChild(k);const m=document.createElement('label');m.textContent='Select Knowledge Base:';m.style.display='block';m.style.marginBottom='5px';m.style.fontSize='14px';a.appendChild(m);const n=document.createElement('select');n.className='knowledgeBaseSelect';n.style.width='100%';n.style.padding='5px';n.style.marginBottom='15px';n.style.borderRadius='3px';n.style.border='1px solid #ccc';n.disabled=true;const o=document.createElement('option');o.value='';o.textContent='-- Select a knowledge base --';n.appendChild(o);a.appendChild(n);const p=document.createElement('div');p.id='llmPrimer-status';p.style.fontSize='13px';p.style.marginBottom='15px';p.style.color='#666';p.style.display='none';a.appendChild(p);const q=document.createElement('div');q.style.display='flex';q.style.justifyContent='space-between';q.style.gap='10px';const r=document.createElement('button');r.id='llmPrimer-inject-btn';r.innerText='Inject Prompt';r.style.padding='8px 15px';r.style.borderRadius='3px';r.style.border='1px solid #ccc';r.style.backgroundColor='#f0f0f0';r.style.cursor='pointer';r.style.flex='1';r.disabled=true;r.addEventListener('click',l);q.appendChild(r);const s=document.createElement('button');s.id='llmPrimer-copy-btn';s.innerText='Copy Prompt';s.style.padding='8px 15px';s.style.borderRadius='3px';s.style.border='1px solid #ccc';s.style.backgroundColor='#f0f0f0';s.style.cursor='pointer';s.style.flex='1';s.disabled=true;s.addEventListener('click',m);q.appendChild(s);a.appendChild(q);document.body.appendChild(a);k.addEventListener('change',function(){f(this.value);n.disabled=!this.value;r.disabled=true;s.disabled=true});n.addEventListener('change',function(){r.disabled=!this.value;s.disabled=!this.value});if(b.length>0){k.value=b[0].id;f(b[0].id);n.disabled=false}q()}catch(a){console.error('Error initializing llmPrimer:',a);alert('Failed to initialize llmPrimer: '+a.message)}}function f(a){try{const b=document.querySelector('.knowledgeBaseSelect');if(!b){throw new Error('Knowledge base select element not found')}while(b.options.length>1){b.remove(1)}const d=c.filter(b=>b.category===a);d.forEach(a=>{const c=document.createElement('option');c.value=a.id;c.textContent=a.title;b.appendChild(c)});if(d.length>0){b.value=d[0].id;const a=document.getElementById('llmPrimer-inject-btn');const c=document.getElementById('llmPrimer-copy-btn');if(a&&c){a.disabled=false;c.disabled=false}}}catch(a){console.error('Error populating knowledge bases:',a);alert('Failed to populate knowledge bases: '+a.message)}}function g(){try{const a=document.querySelector('.knowledgeBaseSelect');if(!a){throw new Error('Knowledge base select element not found')}const b=a.value;if(!b){return''}const d=c.find(a=>a.id===b);return d?d.docxUrl:''}catch(a){console.error('Error getting DOCX URL:',a);return''}}async function h(a){try{if(!a){throw new Error('No valid DOCX URL provided')}i('Fetching DOCX file...');const b=['https://api.allorigins.win/raw?url=','https://corsproxy.io/?','https://cors-anywhere.herokuapp.com/'];let c=null;let d=false;let e=null;try{const b=await fetch(a,{mode:'cors',credentials:'same-origin',headers:{Accept:'application/vnd.openxmlformats-officedocument.wordprocessingml.document'}});if(b.ok){c=await b.arrayBuffer();d=true}}catch(b){console.warn('Direct fetch failed:',b);e=b}if(!d){for(const f of b){try{i(`Trying proxy: ${f.split('?')[0]}...`);const b=f+encodeURIComponent(a);const g=await fetch(b);if(g.ok){c=await g.arrayBuffer();d=true;break}}catch(a){console.warn(`Proxy ${f} failed:`,a);e=a}}}if(!d){i('Trying final alternative method...');try{c=await new Promise((b,c)=>{const d=new XMLHttpRequest();d.open('GET',a,true);d.responseType='arraybuffer';d.onload=function(){if(this.status>=200&&this.status<300){b(this.response)}else{c(new Error(`XHR failed: ${this.status}`))}};d.onerror=function(){c(new Error('Network error occurred'))};d.send()});d=true}catch(a){console.warn('XHR approach failed:',a);e=a}}if(!d||!c){throw new Error(`All fetch methods failed. Last error: ${e?.message||'Unknown error'}`)}i('Converting DOCX to HTML...');const f=await mammoth.convertToHtml({arrayBuffer:c});const g=f.value;i('Converting HTML to Markdown...');const j=new TurndownService();j.addRule('emphasis',{filter:['em','i'],replacement:function(a){return'*'+a+'*'}});j.addRule('strong',{filter:['strong','b'],replacement:function(a){return'**'+a+'**'}});const k=j.turndown(g);i('Conversion complete!');return k}catch(a){console.error('Error processing DOCX:',a);i(`Error: ${a.message}`,true);throw a}}function i(a,b=false){const c=document.getElementById('llmPrimer-status');if(c){c.textContent=a;c.style.display='block';c.style.color=b?'#dc3545':'#666';if(!b&&a==='Conversion complete!'){setTimeout(()=>{c.style.display='none'},5000)}}}function j(){console.log('Prompt injected successfully')}async function l(){try{const a=g();if(!a){alert('No valid DOCX URL found. Please select a knowledge base.');return}i('Starting conversion process...');let b;try{b=await h(a)}catch(b){console.error('Conversion error:',b);alert(`DOCX conversion failed: ${b.message}\n\nThe DOCX file at ${a} could not be accessed or converted. This is likely due to CORS restrictions or an invalid document format.`);return}let c=null;const d=["div#prompt-textarea p.placeholder","textarea[placeholder]","[contenteditable='true']","[role='textbox']",".chatbox-input","#message-input"];for(const a of d){const b=document.querySelector(a);if(b){c=b;break}}if(!c){alert("Text input area not found! Please ensure you're on a compatible LLM interface.");return}if(c.tagName==='TEXTAREA'){c.value=b;c.dispatchEvent(new Event("input",{bubbles:true}));c.dispatchEvent(new Event("change",{bubbles:true}))}else if(c.isContentEditable||c.getAttribute('role')==='textbox'){c.innerText=b;c.dispatchEvent(new Event("input",{bubbles:true}))}else{c.innerText=b;c.dispatchEvent(new Event("input",{bubbles:true}))}i('Text inserted successfully!');setTimeout(()=>{const a=['button[data-testid="send-button"]','button.send-button','button[type="submit"]','button:has(svg)','button.submit','[aria-label="Send message"]'];let b=null;for(const c of a){const a=document.querySelector(c);if(a){b=a;break}}if(b){b.click();j()}else{i('Send button not found. Text inserted but not submitted.',true)}},300)}catch(a){console.error('Error injecting prompt:',a);alert('Failed to inject prompt: '+a.message)}}async function m(){try{const a=g();if(!a){alert('No knowledge base selected!');return}i('Starting conversion for copy...');let b;try{b=await h(a)}catch(b){console.error('Conversion error:',b);alert(`DOCX conversion failed: ${b.message}\n\nThe DOCX file at ${a} could not be accessed or converted.`);return}i('Copying to clipboard...');let c=false;try{if(navigator.clipboard&&navigator.clipboard.writeText){await navigator.clipboard.writeText(b);c=true}else{const a=document.createElement('textarea');a.value=b;a.style.position='fixed';a.style.left='0';a.style.top='0';a.style.opacity='0';a.style.pointerEvents='none';document.body.appendChild(a);a.focus();a.select();c=document.execCommand('copy');document.body.removeChild(a)}}catch(a){console.error('Clipboard operation failed:',a);try{const a=document.createElement('textarea');a.value=b;a.style.position='fixed';a.style.top='10px';a.style.left='10px';a.style.width='80%';a.style.height='150px';a.style.zIndex='10001';document.body.appendChild(a);alert('Automatic copy failed. Please manually copy the text from the text area that has appeared on screen.');a.focus();a.select();setTimeout(()=>{if(document.body.contains(a)){document.body.removeChild(a)}},20000);return}catch(a){console.error('Even fallback textarea failed:',a)}}if(c){const a=document.getElementById('llmPrimer-copy-btn');if(a){const b=a.innerText;a.innerText='âœ“ Copied!';a.style.backgroundColor='#4caf50';a.style.color='white';setTimeout(()=>{a.innerText=b;a.style.backgroundColor='';a.style.color=''},2000)}i('Markdown copied to clipboard!')}else{i('Failed to copy to clipboard',true);alert('Copy operation failed. This may be due to browser permissions.')}}catch(a){console.error('Error in copyPrompt:',a);i('Error during copy operation',true);alert('An error occurred: '+a.message)}}function n(){try{const a=document.getElementById('llmPrimer-panel');if(!a){throw new Error('Panel element not found')}const b=a.getAttribute('data-theme')==='dark';if(b){a.setAttribute('data-theme','light');a.style.backgroundColor='#ffffff';a.style.color='#333333';a.style.border='1px solid #cccccc';const b=a.querySelectorAll('button:not([id="llmPrimer-theme-btn"]):not([id="llmPrimer-toggle-btn"]):not([id="llmPrimer-close-btn"])');b.forEach(a=>{a.style.backgroundColor='#f0f0f0';a.style.color='#333333';a.style.border='1px solid #cccccc'});const c=a.querySelectorAll('select');c.forEach(a=>{a.style.backgroundColor='#ffffff';a.style.color='#333333';a.style.border='1px solid #cccccc'})}else{a.setAttribute('data-theme','dark');a.style.backgroundColor='#333333';a.style.color='#ffffff';a.style.border='1px solid #555555';const b=a.querySelectorAll('button:not([id="llmPrimer-theme-btn"]):not([id="llmPrimer-toggle-btn"]):not([id="llmPrimer-close-btn"])');b.forEach(a=>{a.style.backgroundColor='#444444';a.style.color='#ffffff';a.style.border='1px solid #666666'});const c=a.querySelectorAll('select');c.forEach(a=>{a.style.backgroundColor='#444444';a.style.color='#ffffff';a.style.border='1px solid #666666'})}localStorage.setItem('llmPrimer-theme',b?'light':'dark')}catch(a){console.error('Error toggling theme:',a)}}function q(){try{const a=document.getElementById('llmPrimer-panel');if(!a){throw new Error('Panel element not found')}const b=localStorage.getItem('llmPrimer-theme')||'light';if(b==='dark'){a.setAttribute('data-theme','dark');a.style.backgroundColor='#333333';a.style.color='#ffffff';a.style.border='1px solid #555555';const b=a.querySelectorAll('button:not([id="llmPrimer-theme-btn"]):not([id="llmPrimer-toggle-btn"]):not([id="llmPrimer-close-btn"])');b.forEach(a=>{a.style.backgroundColor='#444444';a.style.color='#ffffff';a.style.border='1px solid #666666'});const c=a.querySelectorAll('select');c.forEach(a=>{a.style.backgroundColor='#444444';a.style.color='#ffffff';a.style.border='1px solid #666666'})}else{a.setAttribute('data-theme','light');a.style.backgroundColor='#ffffff';a.style.color='#333333';a.style.border='1px solid #cccccc';const b=a.querySelectorAll('button:not([id="llmPrimer-theme-btn"]):not([id="llmPrimer-toggle-btn"]):not([id="llmPrimer-close-btn"])');b.forEach(a=>{a.style.backgroundColor='#f0f0f0';a.style.color='#333333';a.style.border='1px solid #cccccc'});const c=a.querySelectorAll('select');c.forEach(a=>{a.style.backgroundColor='#ffffff';a.style.color='#333333';a.style.border='1px solid #cccccc'})}}catch(a){console.error('Error applying theme:',a)}}function o(){try{const a=document.getElementById('llmPrimer-panel');if(!a){throw new Error('Panel element not found')}const b=Array.from(a.children).slice(1);const c=a.getAttribute('data-minimized')==='true';if(c){b.forEach(a=>{a.style.display=''});a.setAttribute('data-minimized','false')}else{b.forEach(a=>{a.style.display='none'});a.setAttribute('data-minimized','true')}}catch(a){console.error('Error toggling panel:',a)}}function p(){try{const a=document.getElementById('llmPrimer-panel');if(a){a.remove()}}catch(a){console.error('Error closing panel:',a)}}})();