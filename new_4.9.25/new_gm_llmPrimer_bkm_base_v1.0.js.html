javascript:(function(){var k={},s={default:"position:fixed;top:20px;right:20px;padding:15px;border-radius:5px;box-shadow:0 0 10px rgba(0,0,0,0.3);z-index:10000;width:300px;font-family:Arial,sans-serif;",fullHeight:"position:absolute;top:0;right:0;padding:15px;box-shadow:0 0 10px rgba(0,0,0,0.3);z-index:10000;width:300px;font-family:Arial,sans-serif;height:100vh;margin:0;"},t={light:{bg:"white",text:"#000",border:"#ccc"},dark:{bg:"#222",text:"#fff",border:"#444"}},c=null,currentStyle="default",currentTheme="light",D=!0,kbCategories=[],kbDomain=[];const addThemeStyles=()=>{if(!document.getElementById("kb-theme-styles")){const e=document.createElement("style");e.id="kb-theme-styles",e.textContent=".kb-light-theme{background-color:white!important;color:#000!important}.kb-light-theme select{background-color:white!important;color:#000!important;border-color:#ccc!important}.kb-dark-theme{background-color:#222!important;color:#fff!important}.kb-dark-theme select{background-color:#222!important;color:#fff!important;border-color:#444!important}#generate-btn{background-color:#49A74C!important;color:white!important}#copy-btn{background-color:#0B78D0!important;color:white!important}#close-btn,#style-toggle,#theme-toggle{background-color:transparent!important}",document.head.appendChild(e)}},l=(e,o)=>{D&&(o==="error"?console.error(`[llmPrimer] ${e}`):console.log(`[llmPrimer] ${e}`))},loadKnowledgeBaseData=()=>{l("Loading llmPrimer_bkm_kbLoader_v1.0.js");const e=document.createElement("script");e.src="llmPrimer_bkm_kbLoader_v1.0.js",e.onload=()=>{l("llmPrimer_bkm_kbLoader_v1.0.js loaded");if(typeof kbCategory!=="undefined"&&typeof kbDomain!=="undefined"){kbCategories=kbCategory,kbDomain=kbDomain,populateCategoryDropdown(),populateKnowledgeBaseDropdown()}else P("Error: kbCategory or kbDomain data not loaded from kbLoader script.")},e.onerror=()=>P("Failed to load llmPrimer_bkm_kbLoader_v1.0.js"),document.head.appendChild(e)},P=e=>{const o=document.getElementById("load-status");o&&(o.textContent=e,o.style.color="red"),document.getElementById("generate-btn").disabled=!0,document.getElementById("copy-btn").disabled=!0;const n=document.querySelector(".knowledgeBaseSelect");n.innerHTML='<option value="">Error loading data</option>',n.disabled=!0,alert(`Loading Error: ${e}\n\nPlease try again or check console for details.`),l(e,"error")},populateCategoryDropdown=()=>{const e=document.querySelector(".categorySelect");if(!e)return;e.innerHTML="",kbCategories.forEach((o,n)=>{const i=document.createElement("option");i.value=o.id,i.textContent=o.title,e.appendChild(i),n===0&&(i.selected=!0)}),e.addEventListener("change",handleCategoryChange)},populateKnowledgeBaseDropdown=e=>{const o=document.querySelector(".knowledgeBaseSelect");if(!o)return;o.innerHTML="",o.disabled=!0;const n=e||document.querySelector(".categorySelect").value,i=kbDomain.filter(e=>e.category===n);if(i.length>0)i.forEach((e,n)=>{const i=document.createElement("option");i.value=e.docxUrl,i.textContent=e.title,o.appendChild(i),n===0&&(i.selected=!0)}),o.disabled=!1;else{const e=document.createElement("option");e.textContent="No Knowledge Bases in this category",e.value="",o.appendChild(e)}updateButtonStates()},handleCategoryChange=e=>{populateKnowledgeBaseDropdown(e.target.value)},getSelectedDocxUrl=()=>{const e=document.querySelector(".knowledgeBaseSelect");return e.value},updateButtonStates=()=>{const e=getSelectedDocxUrl(),o=document.getElementById("generate-btn"),n=document.getElementById("copy-btn");e&&e!==""?(o.disabled=!1,n.disabled=!1):(o.disabled=!0,n.disabled=!0)},I=()=>{const e=getSelectedDocxUrl();if(!e){alert("No Knowledge Base selected to inject.");return}const o=document.querySelector("div#prompt-textarea p.placeholder");o?(o.innerText=e,o.dispatchEvent(new Event("input",{bubbles:!0})),setTimeout(()=>{const e=document.querySelector('button[data-testid="send-button"]');e&&e.click(),R()},100)):alert("Target placeholder not found!")},J=async()=>{const e=getSelectedDocxUrl();if(!e){alert("No Knowledge Base selected to copy.");return}try{await navigator.clipboard.writeText(e);const o=document.getElementById("copy-btn"),n=o.innerText;o.innerText="Copied!",o.style.backgroundColor="#4CAF50",setTimeout(()=>{o.innerText=n,o.style.backgroundColor="#0B78D0"},1500)}catch(e){alert(`Copy failed: ${e}`)}},R=()=>{document.body.removeChild(p),document.removeEventListener("keydown",Y)},Y=e=>{e.key==="Escape"&&R()},p=document.createElement("div");window.KnowledgeBaseLoader={registerBase:()=>{}},addThemeStyles(),p.id="kb-prompt-generator",p.style.cssText=s.default,p.className="kb-light-theme",p.innerHTML=`
        <h2 style="color:#147CBD;margin:28px 0 10px 0;font-size:1.2em">llmPrimer</h2>
        <div style="display:flex;justify-content:end;position:absolute;top:12px;float:right;right:30px;">
            <button id="style-toggle" style="margin:0px 3px;background-color:transparent;border-radius:3px;padding:3px;cursor:pointer" title="Toggle Panel Style" aria-label="Toggle Panel Style">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line></svg>
            </button>
            <button id="theme-toggle" style="background-color:transparent;border-radius:3px;padding:3px;cursor:pointer" title="Toggle Theme" aria-label="Toggle Theme">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </button>
        </div>
        <div id="load-status" style="margin-bottom:10px;padding:5px;background:#f0f0f0;border-radius:3px;font-size:12px;color:orange;">Loading Knowledge Base Data...</div>
        <label style="display:block;margin-bottom:5px;font-size:14px">Select Category:</label>
        <select class="categorySelect" style="width:100%;padding:5px;margin-bottom:15px;border-radius:3px;border:1px solid #ccc"></select>
        <label style="display:block;margin-bottom:5px;font-size:14px">Select Knowledge Base:</label>
        <select class="knowledgeBaseSelect" style="width:100%;padding:5px;margin-bottom:15px;border-radius:3px;border:1px solid #ccc" disabled></select>
        <div style="display:flex;gap:10px;margin-bottom:10px">
            <button id="generate-btn" style="flex:1;padding:8px;background:#49A74C;color:white;border:none;border-radius:3px;cursor:pointer;font-weight:bold" disabled>Inject Prompt</button>
            <button id="copy-btn" style="flex:1;padding:8px;background:#0B78D0;color:white;border:none;border-radius:3px;cursor:pointer;font-weight:bold" disabled>Copy Prompt</button>
        </div>
        <button id="close-btn" aria-label="close prompt generator" style="position:absolute;top:10px;right:10px;background-color:transparent;border:none;cursor:pointer;font-size:16px;font-weight:bold">âœ•</button>
    `,document.body.appendChild(p),document.getElementById("close-btn").addEventListener("click",R),document.getElementById("generate-btn").addEventListener("click",I),document.getElementById("copy-btn").addEventListener("click",J),document.addEventListener("keydown",Y),document.getElementById("style-toggle").addEventListener("click",function(){currentStyle==="default"?(currentStyle="fullHeight",this.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="9" y1="3" x2="9" y2="21"></line></svg>',this.title="Switch to Floating Panel"):(currentStyle="default",this.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line></svg>',this.title="Switch to Full Height Sidebar");const e=p.className;p.style.cssText=s[currentStyle],p.className=e}),document.getElementById("theme-toggle").addEventListener("click",function(){currentTheme==="light"?(currentTheme="dark",this.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>',this.title="Switch to Light Theme",p.className="kb-dark-theme"):(currentTheme="light",this.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>',this.title="Switch to Dark Theme",p.className="kb-light-theme")}),loadKnowledgeBaseData()})();